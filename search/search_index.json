{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83d\ude80 Quickstart","text":"<p>This is a workflow (written in Nextflow) to analyse mitochondrial sequencing experiments. Is is heavily inspired by the gatk-workflows/gatk4-mitochondria-pipeline and by the epi2me-labs/wf-template.</p> <ol> <li>Install Nextflow in your system (see official documentation)</li> <li> <p>Download the GRCh38 release of the Human Genome and its index files. You need to save all these files in the same directory.</p> Links from Google Cloud Life Sciences <ul> <li>Homo_sapiens_assembly38.fasta</li> <li>Homo_sapiens_assembly38.dict</li> <li>Homo_sapiens_assembly38.fasta.fai </li> <li>Homo_sapiens_assembly38.fasta.64.alt</li> <li>Homo_sapiens_assembly38.fasta.64.amb</li> <li>Homo_sapiens_assembly38.fasta.64.ann</li> <li>Homo_sapiens_assembly38.fasta.64.bwt</li> <li>Homo_sapiens_assembly38.fasta.64.pac</li> <li>Homo_sapiens_assembly38.fasta.64.sa</li> </ul> </li> <li> <p>Put your FASTQ files (or symbolic links <code>ln -s &lt;original&gt; &lt;link&gt;</code>) in one directory. Use a name pattern in a way that you can identify your samples from the prefix.</p> Example <pre><code>$ ls test_data/*.fq.gz\ntest_data/SAMPLE-A_R1.fq.gz  test_data/SAMPLE-C_R1.fq.gz\ntest_data/SAMPLE-A_R2.fq.gz  test_data/SAMPLE-C_R2.fq.gz\ntest_data/SAMPLE-B_R1.fq.gz  test_data/SAMPLE-D_R1.fq.gz\ntest_data/SAMPLE-B_R2.fq.gz  test_data/SAMPLE-D_R2.fq.gz\n</code></pre> </li> <li> <p>Run the Human Mitochondrial Workflow</p> Example <pre><code>./nextflow run lmtani/wf-human-mito \\\n    --fastq \"test_data/*_R{1,2}.fq.gz\" \\\n    --reference /path/to/Homo_sapiens_assembly38.fasta \\\n    --outdir name-your-output-directory\n</code></pre> </li> </ol> <p>In the end, you will have variants (VCF) and alignment (BAM) for each sample and a CSV file with information about each sample (coverage, haplogroup, etc). For more details about the meaning of each column, please see the \ud83d\udce6 Outputs section</p> Example <pre><code>$ ls -1 name-your-output-directory/\nalignments/            # Alignments (BAM)\nall_samples.csv        # Information about each sample\nexecution/             # Pipeline execution details\nvariants/              # Variants (VCF)\nworkspace/             # Outputs of each process in the pipeline\n</code></pre>"},{"location":"inputs/","title":"\ud83d\udd27\ufe0f Required inputs","text":"<p>Work in progress...</p>"},{"location":"outputs/","title":"\ud83d\udce6 Explaining the outputs","text":""},{"location":"outputs/#bam-and-vcf-files","title":"BAM and VCF files","text":"<p>Each sample will have an output of:</p> <ul> <li>the alignment (BAM) between its sequencing reads and the mitochondrion genome</li> <li>the variants (VCF) found by using the Mutect2 program.</li> </ul>"},{"location":"outputs/#the-csv-file","title":"The CSV file","text":"<p>This output has many data that can be useful in different ways.</p> <p>I've copy-paste some outputs definitions from Picard documentation and from Haplockeck here for convenience.</p>"},{"location":"outputs/#from-markduplicates-process","title":"From MarkDuplicates process","text":"<p>SampleID: sample name</p> <p>LIBRARY: sample name (parsed from filename) and the barcode (from inside FASTQ file)</p> <p>UNPAIRED_READS_EXAMINED: This is the number of mapped reads examined which did not have a mapped mate pair.</p> <p>READ_PAIRS_EXAMINED: This is the number of mapped reads examined.</p> <p>SECONDARY_OR_SUPPLEMENTARY_RDS: The number of reads that were either secondary or supplementary</p> <p>UNMAPPED_READS: The total number of unmapped reads examined</p> <p>UNPAIRED_READ_DUPLICATES: The number of fragments that were marked as duplicates.</p> <p>READ_PAIR_DUPLICATES: The number of read pairs that were marked as duplicates.</p> <p>READ_PAIR_OPTICAL_DUPLICATES: The number of read pairs duplicates that were caused by optical duplication. Value is always &lt; READ_PAIR_DUPLICATES, which counts all duplicates regardless of source.</p> <p>PERCENT_DUPLICATION: The fraction of mapped sequence that is marked as duplicate.</p> <p>ESTIMATED_LIBRARY_SIZE: The estimated number of unique molecules in the library based on PE duplication.</p>"},{"location":"outputs/#from-collectwgsmetrics-process","title":"From CollectWgsMetrics process","text":"<p>GENOME_TERRITORY: The number of non-N bases in the genome reference over which coverage will be evaluated.</p> <p>MEAN_COVERAGE: The mean coverage in bases of the genome territory, after all filters are applied.</p> <p>SD_COVERAGE: The standard deviation of coverage of the genome after all filters are applied.</p> <p>MEDIAN_COVERAGE: The median coverage in bases of the genome territory, after all filters are applied.</p> <p>MAD_COVERAGE: The median absolute deviation of coverage of the genome after all filters are applied.</p> <p>PCT_EXC_ADAPTER:</p> <p>PCT_EXC_MAPQ: The fraction of aligned bases that were filtered out because they were in reads with low mapping quality (default is &lt; 20).</p> <p>PCT_EXC_DUPE: The fraction of aligned bases that were filtered out because they were in reads marked as duplicates.</p> <p>PCT_EXC_UNPAIRED: The fraction of aligned bases that were filtered out because they were in reads without a mapped mate pair.</p> <p>PCT_EXC_BASEQ: The fraction of aligned bases that were filtered out because they were of low base quality (default is &lt; 20).</p> <p>PCT_EXC_OVERLAP: The fraction of aligned bases that were filtered out because they were the second observation from an insert with overlapping reads.</p> <p>PCT_EXC_CAPPED: The fraction of aligned bases that were filtered out because they would have raised coverage above the capped value (default cap = 250x).</p> <p>PCT_EXC_TOTAL: The total fraction of aligned bases excluded due to all filters.</p> <p>PCT_1X -&gt; PCT_100X: The fraction of bases that attained at least 1X (5X, 10X...) sequence coverage in post-filtering bases.</p> <p>FOLD_80_BASE_PENALTY: The fold over-coverage necessary to raise 80% of bases in \"non-zero-cvg\" targets to the mean coverage level in those targets.</p> <p>FOLD_90_BASE_PENALTY: Similar to above</p> <p>FOLD_95_BASE_PENALTY:</p> <p>HET_SNP_SENSITIVITY: The theoretical HET SNP sensitivity.</p> <p>HET_SNP_Q: The Phred Scaled Q Score of the theoretical HET SNP sensitivity.</p>"},{"location":"outputs/#from-mtdnaserver-process","title":"From mtDnaServer process","text":"<p>Contamination:</p> <p>SampleHomoplasmies:</p> <p>SampleHeteroplasmies</p> <p>SampleMeanCoverage: defines the mean coverage for the sample.</p> <p>HgMajor</p> <p>HgQualityMajor</p> <p>HgMinor</p> <p>HgQualityMinor</p> <p>HomoplasmiesMajor</p> <p>HomoplasmiesMinor</p> <p>HeteroplasmiesMajor</p> <p>HeteroplasmiesMinor</p> <p>MeanHetLevelMajor: The major haplogroup is calculated by using Haplogrep. The input profile includes all homoplasmies and the major component of each heteroplasmy.</p> <p>MeanHetLevelMinor: The minor heteroplasmy level is calculated by averaging the level of the minor component of each heteroplasmy. The sample HG00245 includes two minor components (3010A (0.011), 16356C (0.012)) to calculate the final heteroplasmy level of 0.011.</p> <p>HG_Distance: This column defines the distance between the haplogroups of the major and minor profile using the graph structure of Phylotree 17</p>"},{"location":"outputs/#from-collectalignmentsummarymetrics-process","title":"From CollectAlignmentSummaryMetrics process","text":"<p>CATEGORY: Just being explicity that te reads metrics are only considering paired-end alignments</p> <p>TOTAL_READS: Total of reads in the alignment</p> <p>PF_READS: The total number of reads passing filter (PF), where the filter(s) can be platform/vendor quality controls</p> <p>PCT_PF_READS: The fraction of reads passing filter, PF_READS/TOTAL_READS</p> <p>PF_NOISE_READS: The number of PF reads that are marked as noise reads. A noise read is one which is composed entirely of A bases and/or N bases. These reads are marked as they are usually artifactual and are of no use in downstream analysis.</p> <p>PF_READS_ALIGNED:</p> <p>PCT_PF_READS_ALIGNED: The percentage of PF reads that aligned to the reference sequence. PF_READS_ALIGNED / PF_READS</p> <p>PF_ALIGNED_BASES: The total number of aligned bases, in all mapped PF reads, that are aligned to the reference sequence.</p> <p>PF_HQ_ALIGNED_READS: The number of PF reads that were aligned to the reference sequence with a mapping quality of Q20 or higher signifying that the aligner estimates a 1/100 (or smaller) chance that the alignment is wrong.</p> <p>PF_HQ_ALIGNED_BASES: The number of bases aligned to the reference sequence in reads that were mapped at high quality. Will usually approximate PF_HQ_ALIGNED_READS * READ_LENGTH but may differ when either mixed read lengths are present or many reads are aligned with gaps.</p> <p>PF_HQ_ALIGNED_Q20_BASES: The subset of PF_HQ_ALIGNED_BASES where the base call quality was Q20 or higher.</p> <p>PF_HQ_MEDIAN_MISMATCHES: The median number of mismatches versus the reference sequence in reads that were aligned to the reference at high quality (i.e. PF_HQ_ALIGNED READS).</p> <p>PF_MISMATCH_RATE: The rate of bases mismatching the reference for all bases aligned to the reference sequence.</p> <p>PF_HQ_ERROR_RATE: The fraction of bases that mismatch the reference in PF HQ aligned reads.</p> <p>PF_INDEL_RATE: The number of insertion and deletion events per 100 aligned bases. Uses the number of events as the numerator, not the number of inserted or deleted bases.</p> <p>MEAN_READ_LENGTH: The mean read length of the set of reads examined. When looking at the data for a single lane with equal length reads this number is just the read length. When looking at data for merged lanes with differing read lengths this is the mean read length of all reads.</p> <p>SD_READ_LENGTH: Standard deviation of the read length.</p> <p>MEDIAN_READ_LENGTH: Median of the read length.</p> <p>MAD_READ_LENGTH:</p> <p>MIN_READ_LENGTH: Lenght of the shortest read</p> <p>MAX_READ_LENGTH: Length of the longest read</p> <p>READS_ALIGNED_IN_PAIRS: The number of aligned reads whose mate pair was also aligned to the reference.</p> <p>PCT_READS_ALIGNED_IN_PAIRS: The fraction of reads whose mate pair was also aligned to the reference. READS_ALIGNED_IN_PAIRS / PF_READS_ALIGNED</p> <p>PF_READS_IMPROPER_PAIRS: The number of (primary) aligned reads that are not \"properly\" aligned in pairs (as per SAM flag 0x2).</p> <p>PCT_PF_READS_IMPROPER_PAIRS: The fraction of (primary) reads that are not \"properly\" aligned in pairs (as per SAM flag 0x2). PF_READS_IMPROPER_PAIRS / PF_READS_ALIGNED</p> <p>BAD_CYCLES\": The number of instrument cycles in which 80% or more of base calls were no-calls.</p> <p>STRAND_BALANCE: The number of PF reads aligned to the positive strand of the genome divided by the number of PF reads aligned to the genome.</p> <p>PCT_CHIMERAS: The fraction of reads that map outside of a maximum insert size (usually 100kb) or that have the two ends mapping to different chromosomes.</p> <p>PCT_ADAPTER: The fraction of PF reads that are unaligned and match to a known adapter sequence right from the start of the read.</p> <p>PCT_SOFTCLIP: the fraction of PF bases that are on (primary) aligned reads and are soft-clipped, as a fraction of the PF_ALIGNED_BASES (even though these are not aligned!)</p> <p>PCT_HARDCLIP: The fraction of PF bases that are (on primary, aligned reads and) hard-clipped, as a fraction of the PF_ALIGNED_BASES (even though these are not aligned!)</p> <p>AVG_POS_3PRIME_SOFTCLIP_LENGTH: The average length of the soft-clipped bases at the 3' end of reads.</p>"}]}